--Problem 1.	Employee Address
SELECT TOP 5 e.EmployeeID, e.JobTitle, a.AddressID, a.AddressText
FROM Employees AS e
JOIN Addresses AS a ON e.AddressID = a.AddressID
ORDER BY a.AddressID

--Problem 2.	Addresses with Towns
SELECT TOP 50 e.FirstName, e.LastName, t.Name, a.AddressText
FROM Employees AS e
JOIN Addresses AS a ON e.AddressID = a.AddressID
JOIN Towns AS t ON a.TownID = t.TownID
ORDER BY e.FirstName, e.LastName

--Problem 3.	Sales Employee
SELECT EmployeeID, FirstName, LastName, d.Name AS DepartmentName
FROM Employees AS e
JOIN Departments as d ON e.DepartmentID = d.DepartmentID
WHERE d.Name = 'Sales'

--Problem 4.	Employee Departments
SELECT TOP 5 e.EmployeeID, e.FirstName, e.Salary, d.Name AS DepartmentName
FROM Employees AS e
JOIN Departments AS d ON d.DepartmentID = e.DepartmentID
WHERE e.Salary > 15000
ORDER BY d.DepartmentID

--Problem 5.	Employees Without Project

SELECT TOP (3) e.EmployeeID,
               e.FirstName
FROM Employees AS e
     LEFT OUTER JOIN EmployeesProjects AS ep ON e.EmployeeID = ep.EmployeeID
WHERE ep.EmployeeID IS NULL
ORDER BY e.EmployeeID; 

--Problem 6.	Employees Hired After

SELECT e.FirstName, e.LastName, e.HireDate, d.Name AS DeptName
FROM Employees AS e
JOIN Departments as d ON e.DepartmentID = d.DepartmentID 
	AND (d.[Name] = 'Sales' OR d.[Name] = 'Finance')
WHERE e.HireDate > '1/1/1999'
ORDER BY e.HireDate

--Problem 7.	Employees with Project
SELECT TOP 5 e.EmployeeID, e.FirstName, pr.Name
FROM Employees AS e
JOIN EmployeesProjects AS ep ON e.EmployeeID = ep.EmployeeID
JOIN Projects AS pr ON pr.ProjectID = ep.ProjectID
WHERE pr.StartDate >
(
    SELECT CONVERT(DATE, '13.08.2002', 103)
) AND pr.EndDate IS NULL
ORDER BY e.EmployeeID; 